(this["webpackJsonpweko-facet-search"]=this["webpackJsonpweko-facet-search"]||[]).push([[0],{42:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),l=n(12),c=n.n(l),i=(n(14),n(15),n(42),n(26)),o=n(70),r=n(37),d=n(3);var h=function(e){let{values:t,name:n,labels:s}=e,l=window.location.search.replace(",","%2C")||"?",c=window.location.search.substring(1).split("&");for(let a=0;a<c.length;a++)c[a]=decodeURIComponent(c[a]);let i=[];const o=new RegExp(n);c.forEach((e=>{o.test(e)&&i.push(e)}));let h=[],u=[];t&&t.map((function(e){let t={label:(s[e.name]||e.name)+"("+e.count+")",value:e.name};u.push(t);let a=n+"="+e.name;-1!=c.indexOf(a)&&h.push(t);let l=i.findIndex((e=>e===a));-1!==l&&i.splice(l,1)})),i.length>0&&i.forEach((e=>{let t={label:e.split("=")[1]+"(0)",value:e.split("=")[1]};h.push(t)}));let[m,p]=Object(a.useState)(u);const[b,j]=Object(a.useState)(!0),f=new O,x=c.some((e=>e.includes(n)));return Object(d.jsx)("div",{children:Object(d.jsx)("div",{className:"select-container",children:Object(d.jsx)(r.a,{defaultValue:h,isMulti:!0,name:"Facet_Search",ontrolShouldRenderValue:!1,onChange:e=>{!function(e){let t="";if(l.indexOf("&")>=0){let e=l.split("&");for(let a=0;a<e.length;a++)e[a].indexOf(encodeURIComponent(n)+"=")<0&&(t+="&"+e[a]);t=t.substring(1)}""!=t&&(l=t),e.map((function(e,t){const a=encodeURIComponent(n)+"="+encodeURIComponent(e.value);l+="&"+a})),l=l.replace("q=0","q="),l+=-1==l.indexOf("is_facet_search=")?"&is_facet_search=true":"",window.location.href="/search"+l}(e)},backspaceRemovesValue:!1,isClearable:!1,options:m,onMenuOpen:()=>{b&&(j(!1),x||f.get_facet_search_list(n).then((e=>{const t=e[n];let a=[];t&&t.map((function(e){let t={label:(s[e.name]||e.name)+"("+e.count+")",value:e.name};a.push(t)})),p(a)})).catch((e=>{console.error("loadOptions error occurred:",e)})))},className:"basic-multi-select",classNamePrefix:"select"})})})},u=n(36);var m=function(e){let{value:t,name:n,labels:s}=e;function l(e){let t=new RegExp(/^(\d{8})|(\d{6})|(\d{4})$/).exec(e),n=!1;return t.length>0&&e==t[0]&&(n=!0),n}let c,i,o={},r=[],h=window.location.search.replace(",","%2C")||"?";if(t&&t.map((function(e,t){let n;e.name.length>0&&(n=parseInt(e.name),r.push(n))})),r.length>1)for(i in r.sort(),r=Array.from(new Set(r)),c=100/(r.length-1),r)o[i*c]=r[i].toString();const[m,p]=Object(a.useState)(r[0]),[b,j]=Object(a.useState)(r[i]);return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"col-sm-11",style:{paddingBottom:"20px","white-space":"nowrap"},children:Object(d.jsx)(u.a.Range,{min:0,marks:o,step:c,onChange:function(e){p(o[e[0]]),j(o[e[1]])},defaultValue:[0,100]})}),Object(d.jsxs)("div",{className:"form-group row",children:[Object(d.jsx)("div",{className:"col-sm-5",children:Object(d.jsx)("input",{type:"number",id:"input_head",className:"form-control",value:m,onChange:e=>p(e.target.value)})}),Object(d.jsx)("div",{className:"col-sm-5",children:Object(d.jsx)("input",{type:"number",id:"input_tail",className:"form-control",value:b,onChange:e=>j(e.target.value)})}),Object(d.jsx)("div",{className:"col-sm-2",children:Object(d.jsxs)("button",{type:"button",style:{marginLeft:"3px"},className:"btn btn-primary pull-right",onClick:function(){!function(){let e="";if(h.indexOf("&")>=0){let t=h.split("&");console.log(t);for(let n=0;n<t.length;n++)t[n].indexOf(encodeURIComponent("date_range1_from")+"=")<0&&t[n].indexOf(encodeURIComponent("date_range1_to")+"=")<0&&(e+="&"+t[n]);e=e.substring(1)}""!=e&&(h=e)}();let e=parseInt(m),t=parseInt(b),n="";e&&l(e)&&(n+="&"+encodeURIComponent("date_range1_from")+"="+encodeURIComponent(e)),t&&l(t)&&(n+="&"+encodeURIComponent("date_range1_to")+"="+encodeURIComponent(t)),n&&(h+=n,window.location.href="/search"+h)},children:[" ",s.Goto]})})]})]})};var p=function(e){let{values:t,name:n,labels:a,displayNumber:s}=e,l="id_"+n+"_chkbox",c=CSS.escape(l);const i=e=>{let{id:t,value:n,checked:a,onChange:s}=e;return null!=s?Object(d.jsx)("input",{id:t,className:"facet-chbox",type:"checkbox",checked:a,onChange:s,value:n}):Object(d.jsx)("input",{id:t,className:"facet-chbox",type:"checkbox",defaultChecked:a,value:n})},o=e=>{let{values:t,name:n,isModal:a,displayNumber:s,onChange:l}=e;return t.map(((e,t)=>{if(a||t<s){let s="id_"+n+(a?"_chkbox_mdl_":"_chkbox_")+t,c=e.name+"("+e.count+")",o=-1!=b.indexOf(n+"="+e.name);return Object(d.jsx)("div",{children:Object(d.jsxs)("label",{htmlFor:s,children:[Object(d.jsx)(i,{id:s,value:e.name,checked:o,onChange:l},s),c]})},s)}}))},r=e=>{let{values:t,name:n,modalId:s}=e;return Object(d.jsxs)("div",{className:"chbox-mdl",id:s,children:[Object(d.jsx)("a",{href:"#!",className:"overlay",onClick:h,modalId:s}),Object(d.jsx)("div",{className:"window",children:Object(d.jsxs)("div",{className:"content",children:[Object(d.jsx)("div",{className:"list",children:Object(d.jsx)(o,{values:t,name:n,isModal:!0})}),Object(d.jsxs)("div",{className:"footer",children:[Object(d.jsx)("a",{href:"#!",onClick:h,modalId:s,children:a.cancel}),Object(d.jsx)("button",{type:"button",className:"btn btn-primary",onClick:u,children:a.search})]})]})})]},s)};function h(e){null!=e&&document.getElementById(e.target.getAttribute("modalId")).classList.remove("is-active")}function u(e){const t=[];document.querySelector("#"+c).querySelectorAll(".chbox-mdl input").forEach((e=>{e.checked&&t.push({label:n,value:e.value})})),m(t)}function m(e){let t="";if(p.indexOf("&")>=0){let e=p.split("&");for(let a=0;a<e.length;a++)e[a].indexOf(encodeURIComponent(n)+"=")<0&&(t+="&"+e[a]);t=t.substring(1)}""!=t&&(p=t),e.map((function(e,t){const a=encodeURIComponent(n)+"="+encodeURIComponent(e.value);p+="&"+a})),p=p.replace("q=0","q="),p+=-1==p.indexOf("is_facet_search=")?"&is_facet_search=true":"",window.location.href="/search"+p}let p=window.location.search.replace(",","%2C")||"?",b=window.location.search.substring(1).split("&");for(let d=0;d<b.length;d++)b[d]=decodeURIComponent(b[d]);let j="id_"+n+"_checkbox_modal",f=null==s?5:s;return Object(d.jsx)("div",{id:l,children:Object(d.jsxs)("div",{className:"chbox-container",children:[Object(d.jsx)(o,{values:t,name:n,isModal:!1,displayNumber:f,onChange:function(e){const t=[];document.querySelector("#"+c).querySelectorAll(".chbox-mdl input").forEach((a=>{(a.checked&&e.target.value!==a.value||e.target.checked&&e.target.value===a.value)&&t.push({label:n,value:a.value})})),m(t)}}),t.length>f&&Object(d.jsx)("a",{href:"#"+j,onClick:function(e){null!=e?(document.getElementById(e.target.getAttribute("modalId")).classList.add("is-active"),document.querySelector("#"+c).querySelectorAll(".chbox-mdl input").forEach((e=>{e.checked=-1!=b.indexOf(n+"="+e.value)}))):console.log("event == null")},modalId:j,children:". . . See More"}),Object(d.jsx)(r,{values:t,name:n,modalId:j,displayNumber:s})]})})};var b=function(e){let{item:t,nameshow:n,name:s,key:l,labels:c,isInitOpen:i,uiType:r,displayNumber:u}=e;const b=window.location.search.replace(",","%2C").indexOf(encodeURIComponent(s))>=0||i,[j,f]=Object(a.useState)(b),x=window.location.pathname.split("/")[1].includes("records");return Object(d.jsxs)("div",{className:"panel panel-default",children:[Object(d.jsxs)("div",{className:"panel-heading clearfix",children:[Object(d.jsx)("h3",{className:"panel-title pull-left",children:n}),Object(d.jsxs)("a",{className:"pull-right",onClick:()=>f(!j),children:[!j&&Object(d.jsx)("span",{children:Object(d.jsx)("i",{className:"glyphicon glyphicon-chevron-right"})}),j&&Object(d.jsx)("span",{children:Object(d.jsx)("i",{className:"glyphicon glyphicon-chevron-down"})})]})]}),Object(d.jsx)(o.a,{isOpen:j,children:Object(d.jsxs)("div",{className:"panel-body index-body",children:[!x&&"SelectBox"===r&&Object(d.jsx)(h,{values:t,name:s,labels:c}),null!=t&&!x&&"CheckboxList"===r&&Object(d.jsx)(p,{values:t,name:s,labels:c,displayNumber:u}),null!=t&&!x&&"RangeSlider"===r&&Object(d.jsx)(m,{value:t,name:s,labels:c})]})})]},l)};const j={};let f=document.getElementsByClassName("body-facet-search-label");for(let g=0;g<f.length;g++)j[f[g].id]=f[g].value;class x extends s.a.Component{constructor(e){super(e),this.state={is_enable:!1,list_title:{},list_facet:{},list_order:{},list_uiType:{},list_isOpen:{},list_displayNumber:{}},this.getTitleAndOrder=this.getTitleAndOrder.bind(this),this.get_facet_search_list=this.get_facet_search_list.bind(this),this.convertData=this.convertData.bind(this)}getTitleAndOrder(){let e={},t={},n={},a={},s={};return Object(i.a)("/facet-search/get-title-and-order",{method:"POST"}).then((e=>e.json())).then((l=>{l.status&&(e=l.data.titles,t=l.data.order,n=l.data.uiTypes,a=l.data.isOpens,s=l.data.displayNumbers),this.setState({list_title:e}),this.setState({list_order:t}),this.setState({list_uiType:n}),this.setState({list_isOpen:a}),this.setState({list_displayNumber:s})}))}get_facet_search_list(e){let t,n=new URLSearchParams(window.location.search);return Array.isArray(e)>1&&e.length&&(e=e.join(",")),Object(i.a)("/api/facet-search/condition".concat("?key="+e+"&"+n.toString()),{method:"GET"}).then((e=>e.json())).then((e=>(t=this.convertData(e),t)))}convertData(e){let t={};return e&&Object.keys(e).map((function(n,a){e.hasOwnProperty(n)&&(t[n]=e[n])})),this.setState({list_facet:t}),t}componentDidMount(){const e=this;let t=window.location.search.substring(1).split("&");for(let n=0;n<t.length;n++)t[n]=decodeURIComponent(t[n]);this.getTitleAndOrder().then((n=>{const{list_order:a,list_uiType:s}=this.state;let l=[];Object.keys(a).map((function(e){const n=a[e];(t.some((e=>e.includes(n)))||"CheckboxList"===s[n]||"RangeSlider"===s[n])&&l.push(n)}));const c=window.location.pathname.split("/")[1].includes("records");l.length>0&&!c?e.get_facet_search_list(l).then((t=>{e.setState({is_enable:!0})})):e.setState({is_enable:!0})})).catch((e=>{console.error("getTitleAndOrder error occurred:",e)}))}render(){const{is_enable:e,list_title:t,list_facet:n,list_order:a,list_uiType:s,list_isOpen:l,list_displayNumber:c}=this.state;return Object(d.jsx)("div",{children:e&&Object(d.jsx)("div",{className:"facet-search break-word",children:Object.keys(a).map((function(e,i){const o=a[e],r=n[o],h=t[o],u=l[o],m=s[o],p=c[o];return Object(d.jsx)(b,{item:r,nameshow:h,name:o,labels:j,isInitOpen:u,uiType:m,displayNumber:p},i)}))})})}}var O=x;c.a.render(Object(d.jsx)(s.a.StrictMode,{children:Object(d.jsx)(O,{})}),document.getElementById("app-facet-search"))}},[[68,1,2]]]);
//# sourceMappingURL=main.814fd632.chunk.js.map